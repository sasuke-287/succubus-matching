<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Succubus Realm - 魅惑の館</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="app">
      <header>
        <h1>🌙 Succubus Realm</h1>
        <p>あなたの心を奪う魅惑の存在を見つけて</p>
      </header>

      <div class="card-container">
        <div class="succubus-card" id="succubusCard">
          <div class="succubus-portrait">
            <img id="succubusImage" src="" alt="サキュバスの肖像" />
            <div class="power-badge" id="powerBadge"></div>
          </div>
          <div class="succubus-info">
            <h2 id="succubusName"></h2>
            <p id="succubusType"></p>
            <p id="succubusOrigin"></p>
            <div class="abilities" id="succubusAbilities"></div>
            <p id="succubusDescription"></p>
          </div>
        </div>
      </div>

      <div class="action-buttons">
        <button class="banish-btn" id="banishBtn">🔥</button>
        <button class="seduce-btn" id="seduceBtn">💋</button>
      </div>

      <div class="harem" id="harem">
        <h3>💜 あなたのハーレム</h3>
        <div class="harem-list" id="haremList"></div>
      </div>
    </div>

    <!-- キャラクター詳細表示モーダル -->
    <div id="characterDetailModal" class="modal-overlay">
      <div class="modal-content">
        <button class="modal-close" aria-label="閉じる">&times;</button>
        <div class="detail-header">
          <img class="detail-image" src="" alt="キャラクター画像" />
          <div class="detail-power-badge"></div>
        </div>
        <div class="detail-body">
          <h2 class="detail-name"></h2>
          <p class="detail-type"></p>
          <p class="detail-origin"></p>
          <div class="detail-abilities"></div>
          <p class="detail-description"></p>
        </div>
        <div class="detail-actions">
          <!-- コンテキストに応じてボタンが変わる -->
        </div>
        <div class="detail-external-links">
          <!-- 外部リンクボタン -->
          <button class="external-link-btn" data-link-type="profile">
            📋 詳細プロフィール
          </button>
          <button class="external-link-btn" data-link-type="gallery">
            🖼️ ギャラリー
          </button>
          <button class="external-link-btn" data-link-type="social">
            🌐 ソーシャル
          </button>
        </div>
      </div>
    </div>

    <script src="script.js"></script>
    
    <!-- ホットリロード用スクリプト -->
    <script>
      (function() {
        // 開発環境でのみホットリロードを有効化
        if (location.hostname === 'localhost' || location.hostname === '127.0.0.1') {
          const ws = new WebSocket(`ws://${location.host}`);
          
          ws.onopen = function() {
            console.log('🔥 ホットリロード接続完了');
          };
          
          ws.onmessage = function(event) {
            const data = JSON.parse(event.data);
            
            if (data.type === 'reload') {
              console.log(`📝 ファイル変更検出: ${data.file}`);
              
              // CSSファイルの場合はページリロードせずにスタイルシートを更新
              if (data.file.endsWith('.css')) {
                const links = document.querySelectorAll('link[rel="stylesheet"]');
                links.forEach(link => {
                  const href = link.href;
                  link.href = href + '?t=' + data.timestamp;
                });
                console.log('🎨 CSSを更新しました');
              } else {
                // その他のファイルの場合はページをリロード
                console.log('🔄 ページをリロードします...');
                setTimeout(() => {
                  location.reload();
                }, 100);
              }
            }
          };
          
          ws.onclose = function() {
            console.log('❌ ホットリロード接続が切断されました');
            // 再接続を試行
            setTimeout(() => {
              console.log('🔄 ホットリロード再接続を試行中...');
              location.reload();
            }, 1000);
          };
          
          ws.onerror = function(error) {
            console.log('⚠️ ホットリロードエラー:', error);
          };
        }
      })();
    </script>
  </body>
</html>
