# 要件書

## はじめに

現在の Succubus Realm アプリケーションでは、キャラクターの基本情報（名前、種類、出身、能力値、簡単な説明）のみがカードに表示されています。ユーザーがキャラクターについてより詳しく知りたい場合や、ハーレムに追加したキャラクターの詳細を後から確認したい場合に対応する機能が不足しています。

この機能により、ユーザーはキャラクターの詳細情報を確認でき、より深くキャラクターを理解してから選択を行うことができるようになります。

## 要件

### 要件 1

**ユーザーストーリー:** ユーザーとして、現在表示されているキャラクターの詳細情報を見たいので、カードから詳細画面にアクセスできるようにしたい

#### 受入基準

1. WHEN ユーザーがキャラクターカードをタップ（クリック）した時 THEN システムは詳細表示モーダルを開く SHALL
2. WHEN 詳細表示モーダルが開かれた時 THEN システムはキャラクターの全詳細情報を表示する SHALL
3. WHEN 詳細表示モーダルが開いている時 THEN システムはスワイプ機能を無効化する SHALL

### 要件 2

**ユーザーストーリー:** ユーザーとして、キャラクターの詳細情報を包括的に確認したいので、基本情報以外の追加情報も表示されるようにしたい

#### 受入基準

1. WHEN 詳細表示モーダルが開かれた時 THEN システムは拡大されたキャラクター画像を表示する SHALL
2. WHEN 詳細表示モーダルが開かれた時 THEN システムは詳細な説明文を表示する SHALL
3. WHEN 詳細表示モーダルが開かれた時 THEN システムは各能力値を視覚的なプログレスバーで表示する SHALL
4. WHEN 詳細表示モーダルが開かれた時 THEN システムは総合パワー値をより目立つ形で表示する SHALL

### 要件 3

**ユーザーストーリー:** ユーザーとして、詳細画面からも選択を行いたいので、詳細画面内で誘惑/追放の選択ができるようにしたい

#### 受入基準

1. WHEN 詳細表示モーダルが開いている時 THEN システムは誘惑ボタンと追放ボタンを表示する SHALL
2. WHEN ユーザーが詳細画面で誘惑ボタンを押した時 THEN システムはキャラクターをハーレムに追加し、モーダルを閉じ、次のキャラクターを表示する SHALL
3. WHEN ユーザーが詳細画面で追放ボタンを押した時 THEN システムはキャラクターを追放し、モーダルを閉じ、次のキャラクターを表示する SHALL

### 要件 4

**ユーザーストーリー:** ユーザーとして、詳細画面を簡単に閉じたいので、複数の方法で詳細画面を閉じられるようにしたい

#### 受入基準

1. WHEN ユーザーが詳細表示モーダルの閉じるボタンを押した時 THEN システムはモーダルを閉じ、元のカード表示に戻る SHALL
2. WHEN ユーザーがモーダルの背景部分をクリックした時 THEN システムはモーダルを閉じる SHALL
3. WHEN ユーザーが ESC キーを押した時 THEN システムはモーダルを閉じる SHALL

### 要件 5

**ユーザーストーリー:** ユーザーとして、ハーレムメンバーの詳細も確認したいので、ハーレム一覧からも詳細画面にアクセスできるようにしたい

#### 受入基準

1. WHEN ユーザーがハーレム一覧のメンバーをクリックした時 THEN システムは該当キャラクターの詳細表示モーダルを開く SHALL
2. WHEN ハーレムメンバーの詳細表示モーダルが開かれた時 THEN システムは誘惑/追放ボタンの代わりに「ハーレムから削除」ボタンを表示する SHALL
3. WHEN ユーザーが「ハーレムから削除」ボタンを押した時 THEN システムはキャラクターをハーレムから削除し、モーダルを閉じる SHALL

### 要件 6

**ユーザーストーリー:** ユーザーとして、詳細画面が美しく表示されることを期待するので、アプリの既存デザインと一貫性のある見た目にしたい

#### 受入基準

1. WHEN 詳細表示モーダルが表示される時 THEN システムは既存アプリと同じ色調とスタイルを使用する SHALL
2. WHEN 詳細表示モーダルが表示される時 THEN システムは滑らかなアニメーション効果を適用する SHALL
3. WHEN 詳細表示モーダルが表示される時 THEN システムはレスポンシブデザインを適用し、モバイルデバイスでも適切に表示する SHALL

### 要件 7

**ユーザーストーリー:** ユーザーとして、PC・モバイル双方で快適に詳細画面を操作したいので、各デバイスに最適化された操作性を提供してほしい

#### 受入基準

1. WHEN PC でアクセスした時 THEN システムはマウス操作に最適化されたボタンサイズとホバー効果を提供する SHALL
2. WHEN モバイルデバイスでアクセスした時 THEN システムはタッチ操作に適したボタンサイズ（最小 44px）を提供する SHALL
3. WHEN 画面サイズが変更された時 THEN システムは自動的にレイアウトを調整し、コンテンツが適切に表示される SHALL
4. WHEN モバイルデバイスで詳細画面を表示した時 THEN システムは画面全体を効率的に使用し、スクロール可能な領域を提供する SHALL
5. WHEN PC で詳細画面を表示した時 THEN システムはキーボードナビゲーション（Tab、Enter、ESC）をサポートする SHALL

### 要件 8

**ユーザーストーリー:** ユーザーとして、画像をクリックした時に誤って選択処理が実行されることを避けたいので、画像クリック時は詳細表示のみを行いたい

#### 受入基準

1. WHEN ユーザーがキャラクター画像をクリックした時 THEN システムは詳細表示モーダルのみを開き、誘惑/追放処理は実行しない SHALL
2. WHEN 画像クリック時に詳細表示モーダルが開いた時 THEN システムは下部のアクションボタンを無効化する SHALL
3. WHEN 詳細表示モーダルが閉じられた時 THEN システムはアクションボタンを再有効化する SHALL

### 要件 9

**ユーザーストーリー:** ユーザーとして、スワイプアクションの結果を明確に把握したいので、アクション実行時に視覚的フィードバックを受け取りたい

#### 受入基準

1. WHEN ユーザーが誘惑アクションを実行した時 THEN システムは「💋 誘惑しました！」メッセージを表示する SHALL
2. WHEN ユーザーが追放アクションを実行した時 THEN システムは「🔥 追放しました！」メッセージを表示する SHALL
3. WHEN スワイプアクションが実行された時 THEN システムは対象キャラクター名と残り人数を表示する SHALL
4. WHEN 最後のサキュバスに対してアクションを実行した時 THEN システムは「全ての出会いが完了します」メッセージを表示する SHALL
5. WHEN フィードバックメッセージが表示された時 THEN システムは 0.8 秒後に自動的にメッセージを削除する SHALL

### 要件 10

**ユーザーストーリー:** ユーザーとして、全てのサキュバスとの出会いが完了した時に詳細な結果を確認したいので、統計情報とランクシステムを表示してほしい

#### 受入基準

1. WHEN 全てのサキュバスとの出会いが完了した時 THEN システムはハーレム割合に応じたランク（魅惑の帝王、誘惑の達人、魅惑の探求者、慎重な判断者、孤高の求道者）を表示する SHALL
2. WHEN 結果画面が表示された時 THEN システムはハーレム人数、追放人数、総合パワー、平均パワーの統計を表示する SHALL
3. WHEN 結果画面が表示された時 THEN システムは「新たな誘惑へ」ボタンでリプレイ機能を提供する SHALL
4. WHEN 結果画面が表示された時 THEN システムは「ハーレムを見る」ボタンでハーレム一覧へのスムーススクロール機能を提供する SHALL

### 要件 11

**ユーザーストーリー:** 開発者として、効率的な開発を行いたいので、ファイル変更時に自動的にブラウザが更新されるホットリロード機能を使いたい

#### 受入基準

1. WHEN 開発サーバーが起動された時 THEN システムはファイル監視機能を開始する SHALL
2. WHEN HTML、CSS、JavaScript、JSON ファイルが変更された時 THEN システムは自動的にブラウザをリロードする SHALL
3. WHEN CSS ファイルのみが変更された時 THEN システムはページリロードせずにスタイルシートのみを更新する SHALL
4. WHEN WebSocket 接続が切断された時 THEN システムは自動的に再接続を試行する SHALL
5. WHEN 本番環境（localhost 以外）でアクセスされた時 THEN システムはホットリロード機能を無効化する SHALL

### 要件 12

**ユーザーストーリー:** ユーザーとして、各サキュバスの個性を視覚的に理解したいので、キャラクターごとに異なる色とデザインの淫紋をモチーフにした画像を見たい

#### 受入基準

1. WHEN キャラクターが表示された時 THEN システムは各サキュバスの特性に合った色合いの淫紋画像を表示する SHALL
2. WHEN 画像が表示された時 THEN システムは SVG ベースの高品質な淫紋デザインを使用する SHALL
3. WHEN 画像が表示された時 THEN システムは各キャラクターに対応したシンボル（月、薔薇、仮面、炎、霧など）を含む SHALL
4. WHEN 画像読み込みが失敗した時 THEN システムは適切なフォールバック画像を表示する SHALL
